<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sports Day 2025 - Live Results</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { 
      font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
      min-height:100vh; 
      padding:20px;
    }
    .container { 
      max-width:1400px; 
      margin:0 auto; 
      background:#fff; 
      border-radius:20px; 
      box-shadow:0 20px 40px rgba(0,0,0,.1); 
      overflow:hidden; 
    }
    .header { 
      background:linear-gradient(45deg,#ff6b6b,#4ecdc4); 
      color:#fff; 
      padding:30px; 
      text-align:center; 
      position:relative;
    }
    .header h1 { 
      font-size:2.5em; 
      margin-bottom:10px; 
      text-shadow:2px 2px 4px rgba(0,0,0,.3); 
    }
    .live-indicator {
      display:inline-block;
      background:rgba(255,255,255,0.3);
      padding:8px 20px;
      border-radius:20px;
      margin-top:10px;
      font-weight:bold;
    }
    .live-dot {
      display:inline-block;
      width:10px;
      height:10px;
      background:#00ff00;
      border-radius:50%;
      margin-right:8px;
      animation:pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity:1; }
      50% { opacity:0.3; }
    }
    .last-update {
      position:absolute;
      top:20px;
      right:20px;
      background:rgba(255,255,255,.2);
      padding:10px 15px;
      border-radius:8px;
      font-size:.9em;
    }
    .search-section {
      background:#f8f9fa;
      padding:20px;
      border-bottom:2px solid #e9ecef;
    }
    .search-container {
      max-width:600px;
      margin:0 auto;
      display:flex;
      gap:10px;
    }
    .search-input {
      flex:1;
      padding:12px 20px;
      border:2px solid #ddd;
      border-radius:10px;
      font-size:16px;
    }
    .search-input:focus {
      outline:none;
      border-color:#4ecdc4;
    }
    .search-btn {
      padding:12px 30px;
      background:linear-gradient(45deg,#4ecdc4,#44a08d);
      color:#fff;
      border:none;
      border-radius:10px;
      font-weight:bold;
      cursor:pointer;
      transition:transform .2s;
    }
    .search-btn:hover {
      transform:translateY(-2px);
    }
    .tabs {
      display:flex;
      background:#f8f9fa;
      border-bottom:3px solid #e9ecef;
    }
    .tab {
      flex:1;
      padding:20px;
      text-align:center;
      cursor:pointer;
      font-weight:bold;
      transition:.3s;
      border-bottom:4px solid transparent;
    }
    .tab.active {
      background:#fff;
      border-bottom-color:#4ecdc4;
      color:#4ecdc4;
    }
    .tab:hover:not(.active) {
      background:#e9ecef;
    }
    .content {
      padding:30px;
    }
    .section {
      display:none;
    }
    .section.active {
      display:block;
    }
    .stats-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
      gap:20px;
      margin-bottom:30px;
    }
    .stat-card {
      background:linear-gradient(135deg,#667eea,#764ba2);
      color:#fff;
      padding:25px;
      border-radius:15px;
      text-align:center;
      box-shadow:0 10px 20px rgba(0,0,0,.1);
    }
    .stat-number {
      font-size:3em;
      font-weight:bold;
      margin-bottom:5px;
    }
    .stat-label {
      font-size:1em;
      opacity:0.9;
      text-transform:uppercase;
      letter-spacing:1px;
    }
    .house-card {
      background:#fff;
      border-radius:15px;
      padding:20px;
      box-shadow:0 10px 20px rgba(0,0,0,.1);
      border-left:5px solid;
      transition:transform .2s;
    }
    .house-card:hover {
      transform:translateY(-5px);
    }
    .house-card.chrysanthemum { border-left-color:#ffd700; }
    .house-card.hibiscus { border-left-color:#ff69b4; }
    .house-card.orchid { border-left-color:#9370db; }
    .house-card.sunflower { border-left-color:#ffa500; }
    .house-name {
      font-size:1.5em;
      font-weight:bold;
      margin-bottom:10px;
    }
    .house-points {
      font-size:2.5em;
      font-weight:bold;
      color:#4ecdc4;
    }
    .house-position {
      font-size:0.9em;
      color:#666;
      margin-top:5px;
    }
    .medal-icon {
      font-size:1.5em;
      margin-right:5px;
    }
    .results-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(350px,1fr));
      gap:20px;
      margin-top:20px;
    }
    .results-card {
      background:#fff;
      border-radius:15px;
      padding:20px;
      box-shadow:0 10px 20px rgba(0,0,0,.1);
      border-left:5px solid #ff6b6b;
    }
    .results-card h3 {
      color:#333;
      margin-bottom:15px;
      font-size:1.2em;
    }
    .leaderboard {
      list-style:none;
    }
    .leaderboard li {
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:10px;
      margin-bottom:8px;
      background:#f8f9fa;
      border-radius:8px;
      border-left:4px solid #ddd;
    }
    .leaderboard li.gold {
      border-left-color:#ffd700;
      background:linear-gradient(90deg,#fff9c4,#f8f9fa);
    }
    .leaderboard li.silver {
      border-left-color:#c0c0c0;
      background:linear-gradient(90deg,#f5f5f5,#f8f9fa);
    }
    .leaderboard li.bronze {
      border-left-color:#cd7f32;
      background:linear-gradient(90deg,#f4e4bc,#f8f9fa);
    }
    .student-info {
      flex:1;
    }
    .student-name {
      font-weight:bold;
      color:#333;
    }
    .student-details {
      font-size:.85em;
      color:#666;
    }
    .points {
      font-weight:bold;
      font-size:1.1em;
      color:#4ecdc4;
    }
    .house-colors {
      display:inline-block;
      width:18px;
      height:18px;
      border-radius:50%;
      margin-right:8px;
      vertical-align:middle;
    }
    .chrysanthemum { background-color:#ffd700; }
    .hibiscus { background-color:#ff69b4; }
    .orchid { background-color:#9370db; }
    .sunflower { background-color:#ffa500; }
    .event-timeline {
      max-height:500px;
      overflow-y:auto;
      padding:20px;
      background:#f8f9fa;
      border-radius:10px;
    }
    .timeline-item {
      background:#fff;
      margin-bottom:15px;
      padding:15px;
      border-radius:8px;
      border-left:4px solid #4ecdc4;
      position:relative;
    }
    .timeline-time {
      font-size:0.85em;
      color:#666;
      margin-bottom:5px;
    }
    .timeline-event {
      font-weight:bold;
      color:#333;
      margin-bottom:8px;
    }
    .timeline-results {
      font-size:0.95em;
      line-height:1.6;
    }
    .no-data {
      text-align:center;
      padding:40px;
      color:#666;
      font-size:1.1em;
    }
    .search-results {
      background:#fff;
      border-radius:15px;
      padding:20px;
      margin-top:20px;
      box-shadow:0 10px 20px rgba(0,0,0,.1);
    }
    .search-results h3 {
      color:#333;
      margin-bottom:15px;
    }
    .student-result {
      background:#f8f9fa;
      padding:15px;
      border-radius:8px;
      margin-bottom:10px;
      border-left:4px solid #4ecdc4;
    }
    .refresh-notice {
      text-align:center;
      padding:10px;
      background:#e3f2fd;
      color:#1976d2;
      margin-bottom:20px;
      border-radius:8px;
    }
    @media (max-width: 768px) {
      .header h1 { font-size:1.8em; }
      .stats-grid { grid-template-columns:1fr; }
      .results-grid { grid-template-columns:1fr; }
      .last-update { position:static; margin-top:10px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="last-update">Last Update: <span id="lastUpdate">-</span></div>
      <h1>üèÜ Sports Day 2025</h1>
      <p>Live Results Dashboard</p>
      <div class="live-indicator">
        <span class="live-dot"></span>
        LIVE RESULTS
      </div>
    </div>

    <div class="search-section">
      <div class="search-container">
        <input type="text" id="searchInput" class="search-input" placeholder="Search for a student name...">
        <button class="search-btn" onclick="searchStudent()">Search</button>
      </div>
    </div>

    <div class="tabs">
      <div class="tab active" onclick="showTab(event,'overview')">üìä Overview</div>
      <div class="tab" onclick="showTab(event,'houses')">üè† House Standings</div>
      <div class="tab" onclick="showTab(event,'athletes')">ü•á Top Athletes</div>
      <div class="tab" onclick="showTab(event,'recent')">‚è±Ô∏è Recent Events</div>
    </div>

    <div class="content">
      <div class="refresh-notice">
        üì¢ This page automatically refreshes every 10 seconds to show the latest results
      </div>

      <!-- Search Results (hidden by default) -->
      <div id="searchResults" class="search-results" style="display:none;">
        <h3>Search Results</h3>
        <div id="searchContent"></div>
      </div>

      <!-- Overview Section -->
      <div id="overview" class="section active">
        <h2>üìä Live Statistics</h2>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="totalEvents">0</div>
            <div class="stat-label">Events Completed</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalMedals">0</div>
            <div class="stat-label">Medals Awarded</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalAthletes">0</div>
            <div class="stat-label">Athletes Competing</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="leadingHouse">-</div>
            <div class="stat-label">Leading House</div>
          </div>
        </div>

        <h2 style="margin-top:30px;">üè† Quick House Standings</h2>
        <div class="stats-grid" id="houseQuickView">
          <!-- Houses will be populated here -->
        </div>
      </div>

      <!-- House Standings Section -->
      <div id="houses" class="section">
        <h2>üè† House Championship Standings</h2>
        <div class="stats-grid" id="houseStandings">
          <!-- House standings will be populated here -->
        </div>
      </div>

      <!-- Top Athletes Section -->
      <div id="athletes" class="section">
        <h2>üèÜ Top Athletes by Category</h2>
        <div class="results-grid" id="athleteResults">
          <!-- Athlete results will be populated here -->
        </div>
      </div>

      <!-- Recent Events Section -->
      <div id="recent" class="section">
        <h2>‚è±Ô∏è Recent Event Results</h2>
        <div class="event-timeline" id="eventTimeline">
          <div class="no-data">No events recorded yet</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Data storage
    let students = {};
    let houses = { 'Chrysanthemum':0, 'Hibiscus':0, 'Orchid':0, 'Sunflower':0 };
    let eventLog = [];

    // Load data from localStorage
    function loadData() {
      try {
        const savedHouses = localStorage.getItem('sportsDay_houses');
        const savedStudents = localStorage.getItem('sportsDay_students');
        const savedEventLog = localStorage.getItem('sportsDay_eventLog');
        
        if(savedHouses) houses = JSON.parse(savedHouses);
        if(savedStudents) students = JSON.parse(savedStudents);
        if(savedEventLog) eventLog = JSON.parse(savedEventLog);
        
        updateLastUpdateTime();
        updateAllDisplays();
      } catch(e) {
        console.error('Error loading data:', e);
      }
    }

    // Update last update time
    function updateLastUpdateTime() {
      const now = new Date();
      document.getElementById('lastUpdate').textContent = now.toLocaleTimeString();
    }

    // Tab switching
    function showTab(evt, tabName) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      
      const section = document.getElementById(tabName);
      if(section) section.classList.add('active');
      if(evt && evt.target) evt.target.classList.add('active');
      
      // Hide search results when switching tabs
      document.getElementById('searchResults').style.display = 'none';
    }

    // Search functionality
    function searchStudent() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
      if(!searchTerm) {
        document.getElementById('searchResults').style.display = 'none';
        return;
      }

      const results = Object.entries(students).filter(([name, data]) => 
        name.toLowerCase().includes(searchTerm)
      );

      const searchContent = document.getElementById('searchContent');
      const searchResults = document.getElementById('searchResults');
      
      if(results.length === 0) {
        searchContent.innerHTML = '<div class="no-data">No results found for "' + searchTerm + '"</div>';
      } else {
        let html = '';
        results.forEach(([name, data]) => {
          html += `
            <div class="student-result">
              <div style="font-size:1.2em;font-weight:bold;margin-bottom:10px;">
                <span class="house-colors ${data.house.toLowerCase()}"></span>${name}
              </div>
              <div style="color:#666;margin-bottom:8px;">
                House: <strong>${data.house}</strong> | 
                Category: <strong>${data.category.replace(/_/g,' ').toUpperCase()}</strong>
              </div>
              <div style="font-size:1.1em;">
                ü•á Gold: ${data.gold} | 
                ü•à Silver: ${data.silver} | 
                ü•â Bronze: ${data.bronze}
              </div>
              <div style="font-size:1.3em;font-weight:bold;color:#4ecdc4;margin-top:10px;">
                Total Points: ${data.totalPoints}
              </div>
            </div>
          `;
        });
        searchContent.innerHTML = html;
      }
      
      searchResults.style.display = 'block';
    }

    // Update all displays
    function updateAllDisplays() {
      updateOverview();
      updateHouseStandings();
      updateAthleteResults();
      updateEventTimeline();
    }

    // Update overview
    function updateOverview() {
      // Total events
      document.getElementById('totalEvents').textContent = eventLog.length || '0';
      
      // Total medals
      let totalMedals = 0;
      Object.values(students).forEach(s => {
        totalMedals += s.gold + s.silver + s.bronze;
      });
      document.getElementById('totalMedals').textContent = totalMedals || '0';
      
      // Total athletes
      document.getElementById('totalAthletes').textContent = Object.keys(students).length || '0';
      
      // Leading house
      const sortedHouses = Object.entries(houses).sort(([,a],[,b]) => b - a);
      if(sortedHouses[0] && sortedHouses[0][1] > 0) {
        document.getElementById('leadingHouse').textContent = sortedHouses[0][0];
      } else {
        document.getElementById('leadingHouse').textContent = '-';
      }
      
      // Quick house view
      const houseQuickView = document.getElementById('houseQuickView');
      let houseHtml = '';
      sortedHouses.forEach(([house, points], index) => {
        let medal = '';
        if(index === 0 && points > 0) medal = 'ü•á';
        else if(index === 1 && points > 0) medal = 'ü•à';
        else if(index === 2 && points > 0) medal = 'ü•â';
        
        houseHtml += `
          <div class="house-card ${house.toLowerCase()}">
            <div class="house-name">
              <span class="house-colors ${house.toLowerCase()}"></span>
              ${house}
            </div>
            <div class="house-points">${points} pts</div>
            <div class="house-position">${medal} Position ${index + 1}</div>
          </div>
        `;
      });
      houseQuickView.innerHTML = houseHtml;
    }

    // Update house standings
    function updateHouseStandings() {
      const sortedHouses = Object.entries(houses).sort(([,a],[,b]) => b - a);
      const houseStandings = document.getElementById('houseStandings');
      
      let html = '';
      sortedHouses.forEach(([house, points], index) => {
        let medal = '';
        if(index === 0 && points > 0) medal = 'ü•á';
        else if(index === 1 && points > 0) medal = 'ü•à';
        else if(index === 2 && points > 0) medal = 'ü•â';
        
        html += `
          <div class="house-card ${house.toLowerCase()}">
            <div class="house-name">
              <span class="medal-icon">${medal}</span>
              <span class="house-colors ${house.toLowerCase()}"></span>
              ${house}
            </div>
            <div class="house-points">${points} pts</div>
            <div class="house-position">Position ${index + 1}</div>
          </div>
        `;
      });
      houseStandings.innerHTML = html;
    }

    // Update athlete results
    function updateAthleteResults() {
      const categories = ['grade4_100m','grade4_hyrox','grade5_100m','grade5_hyrox',
                         'u12_100m','u12_hyrox','u14_100m','u14_hyrox',
                         'u16_100m','u16_hyrox','4x100m_relay'];
      
      const athleteResults = document.getElementById('athleteResults');
      let html = '';
      
      categories.forEach(cat => {
        const categoryStudents = Object.entries(students)
          .filter(([n,d]) => d.category === cat)
          .sort(([,a],[,b]) => b.totalPoints - a.totalPoints)
          .slice(0, 3); // Show top 3 only
        
        if(categoryStudents.length > 0) {
          const displayName = cat.replace(/_/g,' ').replace(/\b\w/g, l => l.toUpperCase());
          html += `
            <div class="results-card">
              <h3>${displayName}</h3>
              <ul class="leaderboard">
          `;
          
          categoryStudents.forEach(([name, data], idx) => {
            const medalClass = idx === 0 ? 'gold' : idx === 1 ? 'silver' : idx === 2 ? 'bronze' : '';
            html += `
              <li class="${medalClass}">
                <div class="student-info">
                  <div class="student-name">
                    <span class="house-colors ${data.house.toLowerCase()}"></span>${name}
                  </div>
                  <div class="student-details">${data.house} ‚Ä¢ ü•á${data.gold} ü•à${data.silver} ü•â${data.bronze}</div>
                </div>
                <div class="points">${data.totalPoints} pts</div>
              </li>
            `;
          });
          
          html += '</ul></div>';
        }
      });
      
      if(html === '') {
        html = '<div class="no-data" style="grid-column: 1/-1;">No athlete results yet</div>';
      }
      
      athleteResults.innerHTML = html;
    }

    // Update event timeline
    function updateEventTimeline() {
      const timeline = document.getElementById('eventTimeline');
      
      if(eventLog.length === 0) {
        timeline.innerHTML = '<div class="no-data">No events recorded yet</div>';
        return;
      }
      
      let html = '';
      const recentEvents = eventLog.slice(-10).reverse(); // Show last 10 events
      
      recentEvents.forEach(event => {
        html += '<div class="timeline-item">';
        html += `<div class="timeline-time">${event.timestamp}</div>`;
        html += `<div class="timeline-event">${event.event}`;
        
        if(event.category !== 'House Event') {
          html += ` - ${event.category.replace(/_/g,' ').toUpperCase()}`;
        }
        html += '</div>';
        
        html += '<div class="timeline-results">';
        if(event.category === 'House Event') {
          html += `Winner: <strong>${event.winner}</strong> (${event.points} points)`;
        } else {
          if(event.gold) html += `ü•á ${event.gold}<br>`;
          if(event.silver) html += `ü•à ${event.silver}<br>`;
          if(event.bronze) html += `ü•â ${event.bronze}`;
        }
        html += '</div></div>';
      });
      
      timeline.innerHTML = html;
    }

    // Auto-refresh every 10 seconds
    setInterval(loadData, 10000);

    // Initial load
    loadData();

    // Allow Enter key for search
    document.getElementById('searchInput').addEventListener('keypress', function(e) {
      if(e.key === 'Enter') searchStudent();
    });
  </script>
</body>
</html>